<!DOCTYPE html>
<html>
<head>
<title>Generate Random Code</title>
</head>
<body>
<script>
function isMobileDevice() {
  return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
}

if (!isMobileDevice()) {
  window.location.replace("not-supported.html");
}
</script>

<h1>Generate Random Code</h1>
<p>Click the button to generate a random code.</p>
<input type="button" id="generateCode" value="Generate Code" />
<p>The code is: <span id="code"></span></p>
<script>
function generateCode() {
  var xhr = new XMLHttpRequest();
  xhr.onreadystatechange = function() {
    if (xhr.readyState === 4 && xhr.status === 200) {
      var responseText = xhr.responseText;
      var codes = parseCodes(responseText);

      if (codes.length === 0) {
        document.getElementById("code").innerHTML = "No codes available";
        return;
      }

      var usedCodes = JSON.parse(sessionStorage.getItem("usedCodes")) || [];
      var availableCodes = codes.filter(function(code) {
        return !usedCodes.includes(code);
      });

      if (availableCodes.length === 0) {
        document.getElementById("code").innerHTML = "No codes available";
        return;
      }

      var index = Math.floor(Math.random() * availableCodes.length);
      var code = availableCodes[index];

      document.getElementById("code").innerHTML = code;

      usedCodes.push(code);
      sessionStorage.setItem("usedCodes", JSON.stringify(usedCodes));
    }
  };

  xhr.open("GET", "https://ikghd.site/hhh/icodersf.txt", true);
  xhr.send();
}

// Parse the codes from the text file
function parseCodes(text) {
  var lines = text.split("\n");
  var codes = [];
  for (var i = 0; i < lines.length; i++) {
    var line = lines[i].trim();
    if (line !== "") {
      var code = line.split("-")[1].trim();
      codes.push(code);
    }
  }
  return codes;
}

document.getElementById("generateCode").addEventListener("click", generateCode);
</script>
</body>
</html>
